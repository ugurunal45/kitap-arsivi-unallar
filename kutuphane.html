<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ev KÃ¼tÃ¼phanem</title>

<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial;
  margin: 0;
  padding: 20px;
  background: #f5f5f7;
}

.container {
  max-width: 900px;
  margin: auto;
}

h1 {
  text-align: center;
}

.card {
  background: white;
  padding: 15px;
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0,0,0,.08);
  margin-bottom: 15px;
}

input, button {
  width: 100%;
  padding: 10px;
  margin: 6px 0;
  font-size: 16px;
}

button {
  background: #1a73e8;
  color: white;
  border: none;
  border-radius: 8px;
}

button:hover { opacity: 0.9; }

.book-item {
  padding: 8px 0;
  border-bottom: 1px solid #eee;
}

small { color: gray; }

.admin-info {
  font-size: 13px;
  color: #d32f2f;
}
</style>
</head>

<body>

<div class="container">

<h1>ğŸ“š Ev KÃ¼tÃ¼phanem</h1>

<div class="card">
  <p class="admin-info">
  âœï¸ <b>Not:</b> Yeni kitap ekleyebilmek iÃ§in <b>admin@unallar.com</b> ile giriÅŸ yapmÄ±ÅŸ olmalÄ±sÄ±n.
  </p>

  <input id="emailInput" placeholder="E-posta (admin@unallar.com)">
  <input id="passwordInput" type="password" placeholder="Åifre">

  <button onclick="login()">ğŸ” Admin GiriÅŸi Yap</button>
</div>

<div class="card">
  <h3>â• Yeni Kitap Ekle</h3>

  <input id="isbn" placeholder="ISBN (isteÄŸe baÄŸlÄ±)">
  <input id="title" placeholder="Kitap AdÄ± (zorunlu)">

  <button onclick="addBook()">ğŸ“– KÃ¼tÃ¼phaneye Ekle</button>
  <p id="status"></p>
</div>

<div class="card">
  <h3>ğŸ“š KÃ¼tÃ¼phane Listesi</h3>
  <div id="bookList">YÃ¼kleniyor...</div>
</div>

</div>

<!-- Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } 
from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
import { getFirestore, collection, addDoc, getDocs, query, orderBy } 
from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

// === SENÄ°N KONFÄ°GÄ°N (DEÄÄ°ÅTÄ°RÄ°LMEDÄ°) ===
const firebaseConfig = {
  apiKey: "AIzaSyCKYXjtL0jAvcxTD09NzsQelA0ipYQFr0s",
  authDomain: "kitap-arsivi-8efa5.firebaseapp.com",
  projectId: "kitap-arsivi-8efa5",
  storageBucket: "kitap-arsivi-8efa5.firebasestorage.app",
  messagingSenderId: "712225906954",
  appId: "1:712225906954:web:b4e317515cefa3d3c89af3"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

window.login = async function() {
  const email = document.getElementById("emailInput").value;
  const pass = document.getElementById("passwordInput").value;

  try {
    await signInWithEmailAndPassword(auth, email, pass);
    document.getElementById("status").innerText = "âœ… Admin giriÅŸi baÅŸarÄ±lÄ±.";
  } catch (e) {
    alert("GiriÅŸ hatasÄ±: " + e.message);
  }
};

window.addBook = async function() {
  const isbn = document.getElementById("isbn").value.trim();
  const title = document.getElementById("title").value.trim();

  if (!title) {
    alert("LÃ¼tfen kitap adÄ±nÄ± yaz!");
    return;
  }

  const user = auth.currentUser;

  if (!user || user.email !== "admin@unallar.com") {
    alert("âŒ Sadece admin ekleme yapabilir!");
    return;
  }

  try {
    await addDoc(collection(db, "kutuphane"), {
      title: title,
      isbn: isbn || "",
      createdAt: new Date()
    });

    document.getElementById("status").innerText = "âœ… Kitap eklendi!";
    document.getElementById("title").value = "";
    document.getElementById("isbn").value = "";

    loadBooks();

  } catch (e) {
    alert("KayÄ±t hatasÄ±: " + e.message);
  }
};

async function loadBooks() {
  const listDiv = document.getElementById("bookList");
  listDiv.innerHTML = "YÃ¼kleniyor...";

  const q = query(collection(db, "kutuphane"), orderBy("createdAt", "desc"));
  const snap = await getDocs(q);

  let html = "";

  snap.forEach(doc => {
    const d = doc.data();
    html += `
      <div class="book-item">
        <b>${d.title}</b><br>
        <small>ISBN: ${d.isbn || "â€”"}</small>
      </div>
    `;
  });

  listDiv.innerHTML = html || "HenÃ¼z kitap yok.";
}

// Sayfa aÃ§Ä±lÄ±nca otomatik listele
loadBooks();
</script>

</body>
</html>
